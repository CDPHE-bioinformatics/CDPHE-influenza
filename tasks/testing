        # potentially adjust config file to match theiagen
        IRMA | head -n1 | awk -F' ' '{ print "IRMA " $5 }' | tee VERSION

        # run IRMA
        IRMA ~{irma_module} ~{fastq_R1} ~{fastq_R2} ~{sample_id}

        # determine if assemly was successful
        if compgen -G "~{sample_id}/*.fasta"; then
            proceed=yes
        else 
            TYPE="no IRMA assembly generated"
            HA_SUBTYPE=""
            NA_SUBTYPE=""
        fi

        # if succesful then determine type; if type == A then grab subtype
        if [ $proceed == 'yes' ]; then
            TYPE=$(basename $(find ~{sample_id}/*.fasta | head -n 1 ) | cut -d "_" -f 1)

            ## Type == A then grab subtype if exists
            if [ $TYPE == "A"]; then
                if compgen -G "~{sample_id}/*_HA*.fasta"; then
                    HA_SUBTYPE=$(basename $(find ~{sample_id}/*HA*.fasta | head -n 1 ) | cut -d "_" -f 3 | cut -d "." -f1)
                else
                    HA_SUBTYPE=""
                fi

                if compgen -G "~{sample_id}/*_NA*.fasta"; then
                    NA_SUBTYPE=$(basename $(find ~{sample_id}/*NA*.fasta | head -n 1 ) | cut -d "_" -f 3 | cut -d "." -f1)
                else
                    NA_SUBTYPE=""
                fi
            else
                HA_SUBTYPE=""
                NA_SUBTYPE=""
            fi

            # rename header and file name for fasta
            ## also create an array of the segment names
            for file in ~{sample_id}/*.fasta; do
                # grab base name and drop .fasta
                segment=$(basename ${file%.*})
                # echo $segement >> segment_list.txt
                header_name=$(echo ~{sample_id}_${segment})
                sed -i "s/>.*/>${header_name}/" ${file}

                # rename file
                new_name=$(echo ~{sample_id}_$(basename $file))
                mv "${file}" "${new_name}"
            done

            # rename bam and vcf files
            for file in ~{sample_id}/*{.vcf,.bam,.bai}; do
                new_name=$(echo ~{sample_id}_$(basename $file))
                mv "${file}" "${new_name}"
            done

        fi

        # print variables to files so can read output
        echo ${TYPE} > TYPE.txt
        echo ${HA_SUBTYPE} > HA_SUBTYPE.txt
        echo ${NA_SUBTYPE} > NA_SUBTYPE.txt
    >>>